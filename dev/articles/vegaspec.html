<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Specify using vegaspec • vegawidget</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Specify using vegaspec">
<meta property="og:description" content="vegawidget">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegawidget</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.4.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vegawidget.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vegaspec.html">Specify using vegaspec</a>
    </li>
    <li>
      <a href="../articles/render-vegawidget.html">Render using vegawidget</a>
    </li>
    <li>
      <a href="../articles/shiny.html">Extend using Shiny</a>
    </li>
    <li>
      <a href="../articles/javascript.html">Extend using JavaScript</a>
    </li>
    <li>
      <a href="../articles/image.html">Create Images</a>
    </li>
    <li>
      <a href="../articles/dates-times.html">Work with Dates and Times</a>
    </li>
    <li>
      <a href="../articles/import.html">Import into Other Packages</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vegawidget/vegawidget" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vegaspec_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="vegaspec_files/vega-5.21.0/vega@5.21.0.min.js"></script><script src="vegaspec_files/vega-lite-5.2.0/vega-lite@5.2.0.min.js"></script><link href="vegaspec_files/vega-embed-6.20.2/vega-embed.css" rel="stylesheet">
<script src="vegaspec_files/vega-embed-6.20.2/vega-embed@6.20.2.min.js"></script><script src="vegaspec_files/vegawidget-vl5-binding-0.4.0.9004/vegawidget-vl5.js"></script><link href="vegaspec_files/jsoneditor-5.25.6/jsoneditor.min.css" rel="stylesheet">
<script src="vegaspec_files/jsoneditor-5.25.6/jsoneditor.min.js"></script><script src="vegaspec_files/jsonedit-binding-3.0.0/jsonedit.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Specify using vegaspec</h1>
            
            <h4 data-toc-skip class="date">2022-01-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vegawidget/vegawidget/blob/HEAD/vignettes/articles/vegaspec.Rmd" class="external-link"><code>vignettes/articles/vegaspec.Rmd</code></a></small>
      <div class="hidden name"><code>vegaspec.Rmd</code></div>

    </div>

    
    
<p>The central <em>object</em> of this package is a <em>vegaspec</em>, short for “Vega specification”. This can refer to either a Vega or Vega-Lite specification; in our examples, we work almost exclusively with Vega-Lite.</p>
<p>This article will showcase functions that:</p>
<ul>
<li>build a vegaspec: <code><a href="../reference/as_vegaspec.html">as_vegaspec()</a></code>
</li>
<li>examine a vegaspec: <code><a href="../reference/vw_examine.html">vw_examine()</a></code>
</li>
<li>convert a vegaspec to JSON: <code><a href="../reference/vw_as_json.html">vw_as_json()</a></code>
</li>
<li>resize a vegaspec: <code><a href="../reference/vw_autosize.html">vw_autosize()</a></code>
</li>
<li>compile a Vega-Lite spec to Vega: <code><a href="../reference/vw_to_vega.html">vw_to_vega()</a></code>
</li>
</ul>
<p>The article ends with some “gotchas” (please contribute more as you find them).</p>
<div class="section level2">
<h2 id="building">Building<a class="anchor" aria-label="anchor" href="#building"></a>
</h2>
<p>A vegaspec is created using the constructor <code><a href="../reference/as_vegaspec.html">as_vegaspec()</a></code>, which takes a <code>list</code>, <code>character</code> or a <strong>jsonlite</strong> <code>json</code> object.</p>
<p>Vega and Vega-Lite expect JSON. Because it is easier, in R, to work with lists, a vegaspec “lives” as a list, and then is coerced to JSON when rendered as a vegawidget.</p>
<p>Let’s start with a bar-chart example. The <code>data_category</code> object is a sample dataset included in this package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://vegawidget.github.io/vegawidget">"vegawidget"</a></span><span class="op">)</span>

<span class="va">spec_category</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    `$schema` <span class="op">=</span> <span class="fu"><a href="../reference/vega_schema.html">vega_schema</a></span><span class="op">(</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">data_category</span><span class="op">)</span>,
    mark <span class="op">=</span> <span class="st">"bar"</span>,
    encoding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>field <span class="op">=</span> <span class="st">"category"</span>, type <span class="op">=</span> <span class="st">"nominal"</span><span class="op">)</span>,
      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>field <span class="op">=</span> <span class="st">"number"</span>, type <span class="op">=</span> <span class="st">"quantitative"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/as_vegaspec.html">as_vegaspec</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">spec_category</span></code></pre></div>
<div id="htmlwidget-9c30af88e8117cf5ab74" style="width:auto;height:auto;" class="vegawidget-vl5 html-widget"></div>
<script type="application/json" data-for="htmlwidget-9c30af88e8117cf5ab74">{"x":{
  "chart_spec": {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "data": {
      "values": [
        {
          "category": "a",
          "number": 21
        },
        {
          "category": "b",
          "number": 64
        },
        {
          "category": "c",
          "number": 23
        },
        {
          "category": "d",
          "number": 41
        },
        {
          "category": "e",
          "number": 92
        },
        {
          "category": "f",
          "number": 52
        },
        {
          "category": "g",
          "number": 61
        },
        {
          "category": "h",
          "number": 27
        },
        {
          "category": "i",
          "number": 34
        },
        {
          "category": "j",
          "number": 48
        }
      ]
    },
    "mark": "bar",
    "encoding": {
      "x": {
        "field": "category",
        "type": "nominal"
      },
      "y": {
        "field": "number",
        "type": "quantitative"
      }
    }
  },
  "embed_options": {
    "renderer": "canvas",
    "defaultStyle": true
  }
},"evals":[],"jsHooks":[]}</script><p>Looking at the structure of <code>spec_category</code>, we see that the <code>vegaspec</code> S3 class inherits from <code>list</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">spec_category</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of 4</span>
<span class="co">##  $ $schema : chr "https://vega.github.io/schema/vega-lite/v5.json"</span>
<span class="co">##  $ data    :List of 1</span>
<span class="co">##   ..$ values:Classes 'tbl_df', 'tbl' and 'data.frame':   10 obs. of  2 variables:</span>
<span class="co">##   .. ..$ category: chr [1:10] "a" "b" "c" "d" ...</span>
<span class="co">##   .. ..$ number  : int [1:10] 21 64 23 41 92 52 61 27 34 48</span>
<span class="co">##  $ mark    : chr "bar"</span>
<span class="co">##  $ encoding:List of 2</span>
<span class="co">##   ..$ x:List of 2</span>
<span class="co">##   .. ..$ field: chr "category"</span>
<span class="co">##   .. ..$ type : chr "nominal"</span>
<span class="co">##   ..$ y:List of 2</span>
<span class="co">##   .. ..$ field: chr "number"</span>
<span class="co">##   .. ..$ type : chr "quantitative"</span>
<span class="co">##  - attr(*, "class")= chr [1:4] "vegaspec_unit" "vegaspec_vega_lite" "vegaspec" "list"</span></code></pre>
<p>You can use the helper function <code><a href="../reference/vega_schema.html">vega_schema()</a></code> to generate the string for the <code>$schema</code> element, which can be useful if you are writing a vegaspec manually.</p>
</div>
<div class="section level2">
<h2 id="examining">Examining<a class="anchor" aria-label="anchor" href="#examining"></a>
</h2>
<p>We also have a function, <code><a href="../reference/vw_examine.html">vw_examine()</a></code>, that you can use to, well, examine a vegaspec. This is a thin wrapper around the <code><a href="https://rdrr.io/pkg/listviewer/man/jsonedit.html" class="external-link">listviewer::jsonedit()</a></code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/vw_examine.html">vw_examine</a></span><span class="op">(</span><span class="va">spec_category</span>, mode <span class="op">=</span> <span class="st">"code"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-b8ceef01b7786269b708" style="width:100%;height:432.632880098888px;" class="jsonedit html-widget"></div>
<script type="application/json" data-for="htmlwidget-b8ceef01b7786269b708">{"x":{"data":{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "values": [
      {
        "category": "a",
        "number": 21
      },
      {
        "category": "b",
        "number": 64
      },
      {
        "category": "c",
        "number": 23
      },
      {
        "category": "d",
        "number": 41
      },
      {
        "category": "e",
        "number": 92
      },
      {
        "category": "f",
        "number": 52
      },
      {
        "category": "g",
        "number": 61
      },
      {
        "category": "h",
        "number": 27
      },
      {
        "category": "i",
        "number": 34
      },
      {
        "category": "j",
        "number": 48
      }
    ]
  },
  "mark": "bar",
  "encoding": {
    "x": {
      "field": "category",
      "type": "nominal"
    },
    "y": {
      "field": "number",
      "type": "quantitative"
    }
  }
},"options":{"mode":"code","modes":["view","code","form","text","tree"]}},"evals":[],"jsHooks":[]}</script><p>You might note that, using <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code>, the <code>data$values</code> element of the vegaspec has a column-major format. In R, data frames are lists of vectors; each of the columns is a vector. In the Vega framework, data sets have a row-major format. When rendering, this package converts data-frames automatically to row-major data.</p>
</div>
<div class="section level2">
<h2 id="sizing">Sizing<a class="anchor" aria-label="anchor" href="#sizing"></a>
</h2>
<p>Sizing can be a tricky issue in Vega-Lite.</p>
<p>The first thing to keep in mind is that the default interpretation of width and height refers to the dimensions of the data rectangle. For example, we can set <code>width</code> and <code>height</code> of our example spec:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spec_category_size</span> <span class="op">&lt;-</span> <span class="va">spec_category</span>

<span class="va">spec_category_size</span><span class="op">$</span><span class="va">width</span>  <span class="op">&lt;-</span> <span class="fl">300</span>
<span class="va">spec_category_size</span><span class="op">$</span><span class="va">height</span> <span class="op">&lt;-</span> <span class="fl">300</span>

<span class="va">spec_category_size</span></code></pre></div>
<div id="htmlwidget-072db612c0f91b24524e" style="width:auto;height:auto;" class="vegawidget-vl5 html-widget"></div>
<script type="application/json" data-for="htmlwidget-072db612c0f91b24524e">{"x":{
  "chart_spec": {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "data": {
      "values": [
        {
          "category": "a",
          "number": 21
        },
        {
          "category": "b",
          "number": 64
        },
        {
          "category": "c",
          "number": 23
        },
        {
          "category": "d",
          "number": 41
        },
        {
          "category": "e",
          "number": 92
        },
        {
          "category": "f",
          "number": 52
        },
        {
          "category": "g",
          "number": 61
        },
        {
          "category": "h",
          "number": 27
        },
        {
          "category": "i",
          "number": 34
        },
        {
          "category": "j",
          "number": 48
        }
      ]
    },
    "mark": "bar",
    "encoding": {
      "x": {
        "field": "category",
        "type": "nominal"
      },
      "y": {
        "field": "number",
        "type": "quantitative"
      }
    },
    "width": 300,
    "height": 300
  },
  "embed_options": {
    "renderer": "canvas",
    "defaultStyle": true
  }
},"evals":[],"jsHooks":[]}</script><p>Here, the data rectangle is 300 <span class="math inline">\(\times\)</span> 300 pixels, according to our specification.</p>
<p><img src="autosize-off.png" width="710"></p>
<p>As you can see above, Vega adds on more “room” for axes, labels, legends, etc., so that the entire chart is 349 <span class="math inline">\(\times\)</span> 343 pixels.</p>
<p>If we want to specify the dimensions of the entire chart, we can use the <code><a href="../reference/vw_autosize.html">vw_autosize()</a></code> function. The term “autosize” is taken directly from the Vega <a href="https://vega.github.io/vega-lite/docs/size.html#autosize" class="external-link">documentation</a> for sizing. In this context, the term “autosize” does <strong>not</strong> mean that Vega will try to find the optimal sizing for your chart.</p>
<p>Instead, it means that if you have a requirement for the dimensions of the entire chart, Vega will try to adjust the chart to meet these sizing requirements. The <code><a href="../reference/vw_autosize.html">vw_autosize()</a></code> function modifies the vegaspec to provide Vega these instructions.</p>
<p>Here’s an example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spec_category_autosize</span> <span class="op">&lt;-</span> 
  <span class="va">spec_category</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/vw_autosize.html">vw_autosize</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">300</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>

<span class="va">spec_category_autosize</span></code></pre></div>
<div id="htmlwidget-4406d9f5df02bed531ff" style="width:auto;height:auto;" class="vegawidget-vl5 html-widget"></div>
<script type="application/json" data-for="htmlwidget-4406d9f5df02bed531ff">{"x":{
  "chart_spec": {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "data": {
      "values": [
        {
          "category": "a",
          "number": 21
        },
        {
          "category": "b",
          "number": 64
        },
        {
          "category": "c",
          "number": 23
        },
        {
          "category": "d",
          "number": 41
        },
        {
          "category": "e",
          "number": 92
        },
        {
          "category": "f",
          "number": 52
        },
        {
          "category": "g",
          "number": 61
        },
        {
          "category": "h",
          "number": 27
        },
        {
          "category": "i",
          "number": 34
        },
        {
          "category": "j",
          "number": 48
        }
      ]
    },
    "mark": "bar",
    "encoding": {
      "x": {
        "field": "category",
        "type": "nominal"
      },
      "y": {
        "field": "number",
        "type": "quantitative"
      }
    },
    "width": 300,
    "height": 300,
    "config": {
      "autosize": {
        "type": "fit",
        "contains": "padding"
      },
      "view": {
        "width": 300,
        "height": 300
      }
    }
  },
  "embed_options": {
    "renderer": "canvas",
    "defaultStyle": true
  }
},"evals":[],"jsHooks":[]}</script><p>In this context, the <code>width</code> and <code>height</code> are defined as the dimensions of the entire plot including axes, labels, padding, etc. Here, we have specified the overall dimensions to be 300 <span class="math inline">\(\times\)</span> 300 pixels:</p>
<p><img src="autosize-on.png" width="710"></p>
<p>As you can see above, Vega takes into account the “room” needed for axes, labels, legends, etc., so that the data rectangle is 251 <span class="math inline">\(\times\)</span> 257 pixels.</p>
<p>There are limitations to autosizing; the most prominent is that specifying width and height is <a href="https://vega.github.io/vega-lite/docs/size.html#limitations" class="external-link">effective only for single-view and layered specifications</a>. It will not work for specifications with multiple views (e.g. <code>hconcat</code>, <code>vconcat</code>, <code>facet</code>, <code>`repeat`</code>); there will be no effect on the rendered chart.</p>
<p>For more information, see the Vega-Lite documentation on <a href="https://vega.github.io/vega-lite/docs/size.html#autosize" class="external-link">autosizing</a>.</p>
</div>
<div class="section level2">
<h2 id="compile-to-vega">Compile to Vega<a class="anchor" aria-label="anchor" href="#compile-to-vega"></a>
</h2>
<p>When rendering a Vega-Lite specification, the vega-lite JavaScript library will compile the Vega-Lite specification into Vega. If you have the <a href="https://CRAN.R-project.org/package=V8" class="external-link"><strong>V8</strong></a> package installed, you can compile a Vega-Lite specification to Vega using the <code><a href="../reference/vw_to_vega.html">vw_to_vega()</a></code> function.</p>
<p>To be clear, if you are using only Vega-Lite, this is not something you should ever need to do. This may be useful if you need to design a specification using Vega, and you want get things started using a Vega-Lite specification.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spec_category_vega</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vw_to_vega.html">vw_to_vega</a></span><span class="op">(</span><span class="va">spec_category</span><span class="op">)</span>

<span class="va">spec_category_vega</span></code></pre></div>
<div id="htmlwidget-aa592b99e3e8e75c22e4" style="width:auto;height:auto;" class="vegawidget-vl5 html-widget"></div>
<script type="application/json" data-for="htmlwidget-aa592b99e3e8e75c22e4">{"x":{
  "chart_spec": {
    "$schema": "https://vega.github.io/schema/vega/v5.json",
    "background": "white",
    "padding": 5,
    "height": 200,
    "style": "cell",
    "data": [
      {
        "name": "source_0",
        "values": [
          {
            "category": "a",
            "number": 21
          },
          {
            "category": "b",
            "number": 64
          },
          {
            "category": "c",
            "number": 23
          },
          {
            "category": "d",
            "number": 41
          },
          {
            "category": "e",
            "number": 92
          },
          {
            "category": "f",
            "number": 52
          },
          {
            "category": "g",
            "number": 61
          },
          {
            "category": "h",
            "number": 27
          },
          {
            "category": "i",
            "number": 34
          },
          {
            "category": "j",
            "number": 48
          }
        ]
      },
      {
        "name": "data_0",
        "source": "source_0",
        "transform": [
          {
            "type": "stack",
            "groupby": [
              "category"
            ],
            "field": "number",
            "sort": {
              "field": [],
              "order": []
            },
            "as": [
              "number_start",
              "number_end"
            ],
            "offset": "zero"
          },
          {
            "type": "filter",
            "expr": "isValid(datum[\"number\"]) && isFinite(+datum[\"number\"])"
          }
        ]
      }
    ],
    "signals": [
      {
        "name": "x_step",
        "value": 20
      },
      {
        "name": "width",
        "update": "bandspace(domain('x').length, 0.1, 0.05) * x_step"
      }
    ],
    "marks": [
      {
        "name": "marks",
        "type": "rect",
        "style": [
          "bar"
        ],
        "from": {
          "data": "data_0"
        },
        "encode": {
          "update": {
            "fill": {
              "value": "#4c78a8"
            },
            "ariaRoleDescription": {
              "value": "bar"
            },
            "description": {
              "signal": "\"category: \" + (isValid(datum[\"category\"]) ? datum[\"category\"] : \"\"+datum[\"category\"]) + \"; number: \" + (format(datum[\"number\"], \"\"))"
            },
            "x": {
              "scale": "x",
              "field": "category"
            },
            "width": {
              "scale": "x",
              "band": 1
            },
            "y": {
              "scale": "y",
              "field": "number_end"
            },
            "y2": {
              "scale": "y",
              "field": "number_start"
            }
          }
        }
      }
    ],
    "scales": [
      {
        "name": "x",
        "type": "band",
        "domain": {
          "data": "data_0",
          "field": "category",
          "sort": true
        },
        "range": {
          "step": {
            "signal": "x_step"
          }
        },
        "paddingInner": 0.1,
        "paddingOuter": 0.05
      },
      {
        "name": "y",
        "type": "linear",
        "domain": {
          "data": "data_0",
          "fields": [
            "number_start",
            "number_end"
          ]
        },
        "range": [
          {
            "signal": "height"
          },
          0
        ],
        "nice": true,
        "zero": true
      }
    ],
    "axes": [
      {
        "scale": "y",
        "orient": "left",
        "gridScale": "x",
        "grid": true,
        "tickCount": {
          "signal": "ceil(height/40)"
        },
        "domain": false,
        "labels": false,
        "aria": false,
        "maxExtent": 0,
        "minExtent": 0,
        "ticks": false,
        "zindex": 0
      },
      {
        "scale": "x",
        "orient": "bottom",
        "grid": false,
        "title": "category",
        "labelAlign": "right",
        "labelAngle": 270,
        "labelBaseline": "middle",
        "zindex": 0
      },
      {
        "scale": "y",
        "orient": "left",
        "grid": false,
        "title": "number",
        "labelOverlap": true,
        "tickCount": {
          "signal": "ceil(height/40)"
        },
        "zindex": 0
      }
    ]
  },
  "embed_options": {
    "renderer": "canvas",
    "defaultStyle": true
  }
},"evals":[],"jsHooks":[]}</script><p>We can use the <code><a href="../reference/vw_spec_version.html">vw_spec_version()</a></code> function to check the version of the specification:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/vw_spec_version.html">vw_spec_version</a></span><span class="op">(</span><span class="va">spec_category_vega</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $library</span>
<span class="co">## [1] "vega"</span>
<span class="co">## </span>
<span class="co">## $version</span>
<span class="co">## [1] "5"</span></code></pre>
<p>You can examine the result to see how much-more verbose is the Vega specification, compared to the Vega-Lite specification.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/vw_examine.html">vw_examine</a></span><span class="op">(</span><span class="va">spec_category_vega</span>, mode <span class="op">=</span> <span class="st">"code"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-3b43560996f6d27543a8" style="width:100%;height:432.632880098888px;" class="jsonedit html-widget"></div>
<script type="application/json" data-for="htmlwidget-3b43560996f6d27543a8">{"x":{"data":{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "background": "white",
  "padding": 5,
  "height": 200,
  "style": "cell",
  "data": [
    {
      "name": "source_0",
      "values": [
        {
          "category": "a",
          "number": 21
        },
        {
          "category": "b",
          "number": 64
        },
        {
          "category": "c",
          "number": 23
        },
        {
          "category": "d",
          "number": 41
        },
        {
          "category": "e",
          "number": 92
        },
        {
          "category": "f",
          "number": 52
        },
        {
          "category": "g",
          "number": 61
        },
        {
          "category": "h",
          "number": 27
        },
        {
          "category": "i",
          "number": 34
        },
        {
          "category": "j",
          "number": 48
        }
      ]
    },
    {
      "name": "data_0",
      "source": "source_0",
      "transform": [
        {
          "type": "stack",
          "groupby": [
            "category"
          ],
          "field": "number",
          "sort": {
            "field": [],
            "order": []
          },
          "as": [
            "number_start",
            "number_end"
          ],
          "offset": "zero"
        },
        {
          "type": "filter",
          "expr": "isValid(datum[\"number\"]) && isFinite(+datum[\"number\"])"
        }
      ]
    }
  ],
  "signals": [
    {
      "name": "x_step",
      "value": 20
    },
    {
      "name": "width",
      "update": "bandspace(domain('x').length, 0.1, 0.05) * x_step"
    }
  ],
  "marks": [
    {
      "name": "marks",
      "type": "rect",
      "style": [
        "bar"
      ],
      "from": {
        "data": "data_0"
      },
      "encode": {
        "update": {
          "fill": {
            "value": "#4c78a8"
          },
          "ariaRoleDescription": {
            "value": "bar"
          },
          "description": {
            "signal": "\"category: \" + (isValid(datum[\"category\"]) ? datum[\"category\"] : \"\"+datum[\"category\"]) + \"; number: \" + (format(datum[\"number\"], \"\"))"
          },
          "x": {
            "scale": "x",
            "field": "category"
          },
          "width": {
            "scale": "x",
            "band": 1
          },
          "y": {
            "scale": "y",
            "field": "number_end"
          },
          "y2": {
            "scale": "y",
            "field": "number_start"
          }
        }
      }
    }
  ],
  "scales": [
    {
      "name": "x",
      "type": "band",
      "domain": {
        "data": "data_0",
        "field": "category",
        "sort": true
      },
      "range": {
        "step": {
          "signal": "x_step"
        }
      },
      "paddingInner": 0.1,
      "paddingOuter": 0.05
    },
    {
      "name": "y",
      "type": "linear",
      "domain": {
        "data": "data_0",
        "fields": [
          "number_start",
          "number_end"
        ]
      },
      "range": [
        {
          "signal": "height"
        },
        0
      ],
      "nice": true,
      "zero": true
    }
  ],
  "axes": [
    {
      "scale": "y",
      "orient": "left",
      "gridScale": "x",
      "grid": true,
      "tickCount": {
        "signal": "ceil(height/40)"
      },
      "domain": false,
      "labels": false,
      "aria": false,
      "maxExtent": 0,
      "minExtent": 0,
      "ticks": false,
      "zindex": 0
    },
    {
      "scale": "x",
      "orient": "bottom",
      "grid": false,
      "title": "category",
      "labelAlign": "right",
      "labelAngle": 270,
      "labelBaseline": "middle",
      "zindex": 0
    },
    {
      "scale": "y",
      "orient": "left",
      "grid": false,
      "title": "number",
      "labelOverlap": true,
      "tickCount": {
        "signal": "ceil(height/40)"
      },
      "zindex": 0
    }
  ]
},"options":{"mode":"code","modes":["view","code","form","text","tree"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="gotchas">Gotchas<a class="anchor" aria-label="anchor" href="#gotchas"></a>
</h2>
<p>There are a few things to keep your eyes open-for if you are building vegaspec:</p>
<ul>
<li><p>If the JSON needs a <code>null</code>, supply a <code>NULL</code> from R.</p></li>
<li><p>If the JSON needs an element called <code>repeat</code>, keep in mind that this is a reserved word in R. You can specify such an element using backticks, e.g. <code>list(`repeat` =  ...)</code>.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ian Lyttle, Vega/Vega-Lite Developers.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
